function grn_onsubmit_common(form){for(var elements=form.elements,i=0;i<elements.length;i++)if(elements[i].name&&elements[i].name.indexOf("[]")>0){var options=elements[i].options;if(options)for(var j=0;j<options.length;j++)options[j].selected=!!options[j].value}}function AddMember(fname,cname,sname){var form=document.forms[fname],c=form.elements[cname].options,u=form.elements[sname].options,i,j;for(i=0;i<c.length-1;i++){var co=c[i];if(co.selected&&co.value){var f=false,li=u.length-1;for(j=0;j<li;j++)if(u[j].value==co.value){f=true;break}f||(u[u.length]=new Option(u[li].text,""),u[li]=new Option(co.text,co.value,true,true))}}}function RemoveMember(fname,sname){var u=document.forms[fname].elements[sname].options,li=u.length-1,i;for(i=0;i<li;i++)u[i].selected&&(u[i]=null,li-=1,i-=1)}function au(a,id,text){var li=a.length-1;a[a.length]=new Option(a[li].text,""),a[li]=new Option(text,id),a[li].selected=true}function ag(a,id,text){var li=a.length-1;a[a.length]=new Option(a[li].text,""),a[li]=new Option(text,id)}function OrderTop(fname,sname){var i;if(grn.browser.msie)cb_ui_order_top(fname,sname);else{var form,u=document.forms[fname].elements[sname].options,j=0;for(i=0;i<u.length-1;i++)if(u[i].selected){if(i<=0)break;for(var nTop=j,nCurrent=i;nCurrent>nTop;nCurrent--){var n=new Option(u[nCurrent].text,u[nCurrent].value);u[nCurrent]=new Option(u[nCurrent-1].text,u[nCurrent-1].value),u[nCurrent].selected=u[nCurrent-1].selected,u[nCurrent-1]=n,u[nCurrent-1].selected=true}j++}}}function OrderUp(fname,sname){var i;if(grn.browser.msie)cb_ui_order_up(fname,sname);else{var form,selectedItems=document.forms[fname].elements[sname].options;for(i=0;i<selectedItems.length-1;i++)if(selectedItems[i].selected){if(i<=0)break;var n=new Option(selectedItems[i].text,selectedItems[i].value);"approval_facility_item"==selectedItems[i].className&&(n.className="approval_facility_item"),selectedItems[i]=new Option(selectedItems[i-1].text,selectedItems[i-1].value),"approval_facility_item"==selectedItems[i-1].className&&(selectedItems[i].className="approval_facility_item"),selectedItems[i].selected=selectedItems[i-1].selected,selectedItems[i-1]=n,selectedItems[i-1].selected=true}}}function OrderDown(fname,sname){var i;if(grn.browser.msie)cb_ui_order_down(fname,sname);else{var form,selectedItems=document.forms[fname].elements[sname].options;for(i=selectedItems.length-2;i>=0;i--)if(selectedItems[i].selected){if(i>=selectedItems.length-2)break;var n=new Option(selectedItems[i].text,selectedItems[i].value);"approval_facility_item"==selectedItems[i].className&&(n.className="approval_facility_item"),selectedItems[i]=new Option(selectedItems[i+1].text,selectedItems[i+1].value),"approval_facility_item"==selectedItems[i+1].className&&(selectedItems[i].className="approval_facility_item"),selectedItems[i].selected=selectedItems[i+1].selected,selectedItems[i+1]=n,selectedItems[i+1].selected=true}}}function OrderBottom(fname,sname){var i;if(grn.browser.msie)cb_ui_order_bottom(fname,sname);else{var form,u=document.forms[fname].elements[sname].options,j=u.length-2;for(i=u.length-2;i>=0;i--)if(u[i].selected){if(i>=u.length-2)break;for(var nBottom=j,nCurrent=i;nCurrent<nBottom;nCurrent++){var n=new Option(u[nCurrent].text,u[nCurrent].value);u[nCurrent]=new Option(u[nCurrent+1].text,u[nCurrent+1].value),u[nCurrent].selected=u[nCurrent+1].selected,u[nCurrent+1]=n,u[nCurrent+1].selected=true}j--}}}function popupWin(Aurl,Aname,Awidth,Aheight,Atoolbar,Alocation,Astatus,Ascroll,Amenu,Aresize){var Astr="",openwindow;""!=Awidth&&(Astr+="width="+Awidth),""!=Astr&&(Astr+=","),""!=Aheight&&(Astr+="height="+Aheight),""!=Astr&&(Astr+=","),Atoolbar&&(Astr+="toolbar"),Alocation&&(Astr+=",location"),Astatus&&(Astr+=",status"),Ascroll&&(Astr+=",scrollbars"),Amenu&&(Astr+=",menubar"),Aresize&&(Astr+=",resizable"),""===Aurl&&(grn.browser.safari||grn.browser.mobilesafari)&&(Aurl=grn.component.url.page("blank")),(openwindow=window.open(Aurl,Aname,Astr)).focus()}function popupWin_returnWin(Aurl,Aname,Awidth,Aheight,Atoolbar,Alocation,Astatus,Ascroll,Amenu,Aresize){var Astr="",openwindow;return""!=Awidth&&(Astr+="width="+Awidth),""!=Astr&&(Astr+=","),""!=Aheight&&(Astr+="height="+Aheight),""!=Astr&&(Astr+=","),Atoolbar&&(Astr+="toolbar"),Alocation&&(Astr+=",location"),Astatus&&(Astr+=",status"),Ascroll&&(Astr+=",scrollbars"),Amenu&&(Astr+=",menubar"),Aresize&&(Astr+=",resizable"),""===Aurl&&(grn.browser.safari||grn.browser.mobilesafari)&&(Aurl=grn.component.url.page("blank")),(openwindow=window.open(Aurl,Aname,Astr)).focus(),openwindow}function IsAliveWindow(winVar){var ua=navigator.userAgent;if(!winVar)return false;if(-1!=ua.indexOf("Gecko")&&-1!=ua.indexOf("Win")){if(winVar.closed)return false}else if("object"!=typeof winVar.document)return false;return true}function postdata(fname){var form;document.forms[fname].submit()}function interval(fname,time){setTimeout("postdata('"+fname+"')",time)}function grn_is_checked(form,target_name){for(var elements=form.elements,is_checked=false,i=0;i<elements.length;i++)if(elements[i].name==target_name&&elements[i].checked){is_checked=true;break}return is_checked}function grn_is_selected(form,target_name){for(var elements=form.elements,is_selected=false,options,i=0;i<elements.length;i++)if(elements[i].name==target_name){options=elements[i].options;for(var j=0;j<options.length;j++)if(options[j].selected){is_selected=true;break}}return is_selected}function grn_add_option(select_obj,value,text){var last=select_obj.length-1;select_obj[select_obj.length]=new Option(select_obj[last].text,""),select_obj[last]=new Option(text,value)}function display_pulldown(id){dp_id&&id!=dp_id&&(document.getElementById(dp_id).style.display="none");var e=document.getElementById(id);e&&e.style&&("none"==e.style.display?e.style.display="":e.style.display="none"),dp_id=id}function button_pulldown(id){dp_id&&id!=dp_id&&(document.getElementById(dp_id).style.visibility="hidden");var e=document.getElementById(id);e&&e.style&&("hidden"==e.style.visibility?e.style.visibility="visible":e.style.visibility="hidden"),dp_id=id}function GetInsertIndex(value,dest,sort){for(var is_index=false,k=0;k<sort.length;k++)sort[k]==value&&(is_index=true);if(!is_index)return-1;for(var index=0,i=0;i<dest.length-1;i++){for(var is_found=false,j=0;j<sort.length&&sort[j]!=value;j++)if(sort[j]==dest[i].value){index++,is_found=true;break}if(!is_found)break}return index}function MoveOption(form,sname,cname,index){var s=form.elements[sname].options,c=form.elements[cname].options,sort,co,so;null!=index&&(sort=index.split(":"));for(var k=0;k<c.length;k++)(co=c[k]).selected&&(co.selected=false);for(var j=0;j<s.length-1;j++)if((so=s[j]).selected&&so.value){var o=document.createElement("OPTION");if(o.value=so.value,o.text=so.text,o.selected=true,null!=sort){var order=GetInsertIndex(o.value,c,sort);order>=0&&c.add(o,order)}else{var cl=c.length-1;c.add(o,cl)}}for(var sl=s.length-1,i=0;i<sl;i++)s[i].selected&&(s[i]=null,sl-=1,i-=1)}function insertText(fobj,target){var txt=target.value,id=fobj.selectedIndex;fobj.options[id].value&&(txt+=inText[fobj.options[id].value],txt+="\n",target.value=txt)}function changeDate(form,sobj,year,month,day){var y=sobj+"year",m=sobj+"month",d=sobj+"day",i;for(i=0;i<form.elements[y].options.length;i++)form.elements[y].options[i].value==year&&(form.elements[y].options[i].selected=true,form.elements[y].onchange());for(i=0;i<form.elements[m].options.length;i++)form.elements[m].options[i].value==month&&(form.elements[m].options[i].selected=true,form.elements[m].onchange());for(i=0;i<form.elements[d].options.length;i++)form.elements[d].options[i].value==day&&(form.elements[d].options[i].selected=true,form.elements[d].onchange())}function selectOff(type,form,name){var i;if("ymd"==type){var y=name+"year",m=name+"month",d=name+"day";form.elements[y].disabled=true,form.elements[m].disabled=true,form.elements[d].disabled=true}if("cbx"==type){form.elements[name].disabled=true;var l=document.getElementsByTagName("label");for(i=0;i<l.length;i++){var forName;"time_stump1"==l[i].getAttributeNode("for").nodeValue&&(l[i].className="form_disable")}}}function selectOn(type,form,name){var i;if("ymd"==type){var y=name+"year",m=name+"month",d=name+"day";form.elements[y].disabled=false,form.elements[m].disabled=false,form.elements[d].disabled=false}if("cbx"==type){form.elements[name].disabled=false;var l=document.getElementsByTagName("label");for(i=0;i<l.length;i++){var forName;"time_stump1"==l[i].getAttributeNode("for").nodeValue&&(l[i].className="")}}}function typeChange(fname,e,v){var f=document.forms[fname],d;f.elements[e][v].checked&&(selectOn("ymd",f,"end_"),selectOff("ymd",f,"start_"))}function display_on_off(id){var inID,e,i;if(id.match(/:/)){if((inID=id.split(":")).length>0)for(i=0;i<inID.length;i++)(e=document.getElementById(inID[i]))&&e.style&&("none"==e.style.display?e.style.display="":e.style.display="none")}else dp_of&&id!=dp_of&&(document.getElementById(dp_id).style.display="none"),(e=document.getElementById(id))&&e.style&&("none"==e.style.display?e.style.display="":e.style.display="none"),dp_of=id}function display_on(id){document.getElementById(id).style.display=""}function display_off(id){document.getElementById(id).style.display="none"}function display_on_off_check_by_name(form,name){for(var elements=document.getElementsByName(name),i=0;i<elements.length;i++){var e=elements[i];e&&e.style&&(form.checked?e.style.display="":e.style.display="none")}}function radio_select(fname,cname,sname){var form,c=document.forms[fname].elements[cname],i;for(i=0;i<c.length;i++)c[i].value==sname&&(c[i].checked=true)}function _cb_ui_order_swap_option(options,index1,index2){var text=options[index1].text,value=options[index1].value,selected=options[index1].selected;options[index1].text=options[index2].text,options[index1].value=options[index2].value,options[index1].selected=options[index2].selected,options[index2].text=text,options[index2].value=value,options[index2].selected=selected}function cb_ui_order_top(fname,sname){var form,u=document.forms[fname].elements[sname].options,j=0,i;for(i=0;i<u.length-1;i++)if(u[i].selected){if(0==i){j++;continue}for(var k=i;k>j;k--)_cb_ui_order_swap_option(u,k,k-1),u[k-1].selected=true;j++}}function cb_ui_order_up(fname,sname){for(var form,u=document.forms[fname].elements[sname].options,i=0;i<u.length-1;i++)if(u[i].selected){if(0==i)break;_cb_ui_order_swap_option(u,i,i-1),u[i-1].selected=true}}function cb_ui_order_down(fname,sname){for(var form,u=document.forms[fname].elements[sname].options,i=u.length-2;i>=0;i--)if(u[i].selected){if(i>=u.length-2)break;_cb_ui_order_swap_option(u,i,i+1),u[i+1].selected=true}}function cb_ui_order_bottom(fname,sname){for(var form,u=document.forms[fname].elements[sname].options,j=u.length-2,i=u.length-2;i>=0;i--)if(u[i].selected){if(i>=u.length-2){j--;continue}for(var k=i;k<j;k++)_cb_ui_order_swap_option(u,k,k+1),u[k+1].selected=true;j--}}function grn_check_all(form,element_name){var e=form.elements,l=e.length,checked=false,i;for(i=0;i<l;i++)e[i].name!=element_name||e[i].checked||(checked=true);for(i=0;i<l;i++)e[i].name==element_name&&(e[i].checked=checked)}function tpon(ev,val){0!=tpid&&clearTimeout(tpid),tpleft=ev.clientX+document.body.scrollLeft+5,tptop=ev.clientY+document.body.scrollTop+15,tpval=val,tpid=setTimeout("tpvis()",500)}function tpvis(){var tp=document.getElementById("TTip");if(null==tp)with(tp=document.createElement("div"),tp.setAttribute("id","TTip"),document.body.appendChild(tp),tp.style)position="absolute",backgroundColor="#ffffdd",width="auto",borderStyle="solid",borderWidth="1px",padding="2px",fontSize="12px",zIndex=1e3;if(tp&&""!=tpval){var winwidth=document.body.clientWidth+document.body.scrollLeft;tpleft+100>winwidth&&(tpleft-=tpleft+100-winwidth);var winheight=document.body.clientHeight+document.body.scrollTop;tptop+70>winheight&&(tptop-=tptop+70-winheight),tp.style.left=tpleft+"px",tp.style.top=tptop+"px",tp.innerHTML=tpval,tp.style.visibility="visible"}}function tpoff(){0!=tpid&&clearTimeout(tpid),tptop=tpleft=tpid=0,tpval=null;var tp=document.getElementById("TTip");tp&&(tp.style.visibility="hidden")}function GRN_GroupItem(gid,name,callback,selected,extra_param){this.gid=gid,this.name=name,this.callback=callback,this.selected=selected,this.extra_param=extra_param}function GRN_GroupItemManager(el_group_item){this.el_group_item=el_group_item,this.items=[]}function isSafari(){var ua,m=navigator.userAgent.match(/AppleWebKit\/(\d+)/);return!(!m||!m[1])}function grn_split_tags(data,length){var max_len=100,str="",truncate_str="",escapeHTML_str="",ret="",tmp_div,tmp_div_text;return void 0==length&&(length=100),truncate_str=truncate(str=data.replace(/<\/?[^>]+>/gi,"").replace(/&nbsp;/g," ").replace(/\n/g," ").replace(/\s+/g," ").trim().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"),length+3,"..."),ret=(escapeHTML_str=jQuery("<div id='tmpdiv'></div>").text(truncate_str.replace(/(.{10})/g,"$1&lt;wbr&gt;")).html()).replace(/(&amp;lt;wbr&amp;gt;)/g,"<wbr>")}function truncate(str,length,suffix){var slice_length=length;return suffix.length>0&&(slice_length=length-suffix.length),slice_length>=str.length?str:str.slice(0,slice_length)+suffix}function on_before_delete_follow(form,params){var follow_id=this.id.split("_").pop(),follow_data_id="follow_"+follow_id;params.follow_prefix&&(follow_data_id=params.follow_prefix+follow_id);var follow_data=grn_split_tags(document.getElementById(follow_data_id).innerHTML),msgbox_follow=jQuery(form).find("span").filter(function(){return"msgbox_follow"==jQuery(this).attr("id")}).eq(0);msgbox_follow.length>0&&jQuery(msgbox_follow).html(follow_data);var input=document.createElement("input");input.setAttribute("type","hidden"),input.setAttribute("name",params.follow_id),input.setAttribute("value",follow_id),form.appendChild(input)}function displayTimeZone(check_id,display_member_tz_url,csrf_ticket,is_confirm){var checkbox=jQuery("#"+check_id),scheduleWrapper=jQuery("table.scheduleWrapperTimezoneBar").eq(0),bar_login_timezones=scheduleWrapper.find("tr.bar_login_timezone"),bar_user_timezones=scheduleWrapper.find("tr.bar_user_timezone"),member_tz=0,ajaxRequest;member_tz=checkbox.prop("checked")?(bar_user_timezones.each(function(){jQuery(this).css({display:""})}),bar_login_timezones.each(function(){jQuery(this).css({display:"none"})}),1):(bar_user_timezones.each(function(){jQuery(this).css({display:"none"})}),bar_login_timezones.each(function(){jQuery(this).css({display:""})}),0),new grn.component.ajax.request({url:display_member_tz_url,method:"post",data:"member_tz="+member_tz+"&csrf_ticket="+csrf_ticket+"&confirm="+is_confirm,grnRedirectOnLoginError:true}).send()}function fastGetElementsByClassName(id,tag_name,class_name){var parent_ele=document.getElementById(id),ret=[];if(parent_ele)for(var child_eles=parent_ele.getElementsByTagName(tag_name),tmp_ele=null,i=0;i<child_eles.length;i++)-1!=(tmp_ele=child_eles[i]).className.indexOf(class_name)&&ret.push(tmp_ele);return ret}function HideApplicationMenu(){var applicationMenu=jQuery(".application_menu_visible_grn"),appmenuToggler=jQuery("#appmenuToggler");applicationMenu.addClass("application_menu_hidden_grn"),applicationMenu.removeClass("application_menu_visible_grn"),appmenuToggler.attr("class","appmenuCollapse")}function ShowApplicationMenu(){var applicationMenu=jQuery(".application_menu_hidden_grn"),appmenuToggler;jQuery("#appmenuToggler").attr("class","appmenuExpand"),applicationMenu.removeClass("application_menu_hidden_grn"),applicationMenu.addClass("application_menu_visible_grn")}function ToggleApplicationMenu(){var appmenuToggler,state=1,ajaxRequest;jQuery("#appmenuToggler").hasClass("appmenuExpand")&&(state=0),0===state?HideApplicationMenu():ShowApplicationMenu(),new grn.component.ajax.request({url:command_show_hide_applicationMenu_url,method:"post",data:"stateApplication="+state,grnRedirectOnLoginError:true}).send()}function fastGetElementsByName(id,tag_name,name){var parent_ele=null,ret=[];if(parent_ele="object"==typeof id?id:document.getElementById(id))for(var child_eles=parent_ele.getElementsByTagName(tag_name),tmp_ele=null,i=0;i<child_eles.length;i++)(tmp_ele=child_eles[i]).name==name&&ret.push(tmp_ele);return ret}function setIFrameContent(iframe,bodyContent,base_url){if(iframe){var fdocument=iframe.contentDocument||iframe.contentWindow.document;return fdocument.write("<!DOCTYPE html>"),fdocument.close(),fdocument.head.innerHTML='<meta http-equiv="X-UA-Compatible"><base href="'+base_url+'" target="_parent">',fdocument.body.style.margin=0,fdocument.body.innerHTML=bodyContent,"function"===typeof resize&&resize(),fdocument}}function isTouchDevice(){var retsts="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;return"undefined"!=typeof browser_type&&"msie"==browser_type&&browser_ver_major>=10&&(retsts=window.navigator.msMaxTouchPoints>0),retsts}function cumulativeOffset(element){for(var valueT=0,valueL=0;valueT+=element.offsetTop||0,valueL+=element.offsetLeft||0,element=element.offsetParent;);return returnOffset(valueL,valueT)}function cumulativeOffsetByOffsetParent(element,parent){for(var valueT=0,valueL=0;valueT+=element.offsetTop||0,valueL+=element.offsetLeft||0,(element=element.offsetParent)&&element!==parent;);return returnOffset(valueL,valueT)}function returnOffset(l,t){var result=[l,t];return result.left=l,result.top=t,result}function BuilderDropdownColorControl(dialogId){!function($){if(selectionElement=void 0!=dialogId?$("div#"+dialogId+" select[name=menu]").addClass("hidden"):$("select[name=menu]"),!(selectionElement.length<=0)){selectionElement.addClass("hidden"),holderColorPicker=$("<dl/>",{class:"pulldownbutton_standard_grn event_menu_grn"});var inpel=selectionElement.parent().children("input"),ieformat="";inpel.css("margin-top","0");var ua=navigator.userAgent.toLowerCase(),is_safari=ua.indexOf("safari")>-1&&ua.indexOf("version")>-1,version=is_safari?ua.match(/version\/([\d\.]+)/i)[1].substr(0,1):null;layout=is_safari&&"5"==version?$("<div />",{class:"event_add_base_grn fleft"}).append($("<div />",{class:"mRight3 fleft"}).css("padding-top","").append(holderColorPicker)).append($("<div />").addClass("fleft")):$("<div />",{class:"event_add_base_grn fleft"}).append($("<div />",{class:"mRight3 fleft"}).css("padding-top","").append(holderColorPicker)).append($("<div />").addClass("fleft").append(inpel)),layout.prependTo(selectionElement.parent());var optionRows=selectionElement.children(),textDefault=optionRows.first().text(),pattern=/(^.*);#(.*)/i,span_color=$("<span/>"),data,ar,ev_me_tit,ev_me_class,curob;$.each(optionRows,function(index,obj){curob=$(this),data=curob.val(),null!=(ar=pattern.exec(data))&&ar.length>0&&(ev_me_tit=ar[1],""==(ev_me_class=ar[2])&&curob.val(ev_me_tit))});var span_text=$("<span/>",{class:"mRight3",text:textDefault}),span_up_down=$("<span/>",{class:"pulldownbutton_arrow_down_grn"}),ael=$("<a/>",{href:"javascript:void(0)",title:grn.component.i18n.cbMsg("grn.schedule","GRN_SCH-1076")}).append(span_color).append(span_text).append(span_up_down);holderColorPicker.append($("<dt/>",{style:"margin:0;padding:0"}).append(ael)).append($("<dd/>",{style:"margin:0;padding:0"}).append($("<ul/>",{class:"dropdownContents_grn js_customization_appointment_type"})));for(var user_entry=new Array,ad_entry=new Array,i=0,j=0,k=0,ind=0,data,ii=0;ii<optionRows.length;ii++)if(""==(data=$(optionRows[ii]).val())){ind=ii;break}for(var u=ind+1;u<optionRows.length;u++)data=$(optionRows[u]).val(),null!=(ar=pattern.exec(data))&&ar.length>0?(ev_me_tit=ar[1],ev_me_class=ar[2],""!=ev_me_tit&&(""==ev_me_class?(user_entry[i]=new Array(ev_me_tit,ev_me_class),i++):(ad_entry[k]=new Array(ev_me_tit,ev_me_class),k++))):null!=data&&(user_entry[i]=new Array(data,""),i++);var ulel=holderColorPicker.find("ul"),leng_w=0,is_Japanese=0,have_Japanese=0;if(ulel.css({"z-index":"986","max-height":"300px",overflow:"auto","overflow-x":"hidden","-ms-overflow-x":"hidden"}),void 0!=dialogId&&ulel.css({"z-index":"1501"}),0!=ind){var ite,data=(ite=optionRows.first()).val(),a;null!=(a=pattern.exec(data))&&a.length>0?(ev_me_tit=a[1],ev_me_cl=0!=a[2]?a[2]:"_none",ulel.append($("<li />",{ca:ev_me_cl,te:ev_me_tit}).append($("<a/>",{href:"javascript:void(0)"}).append($("<span/>",{class:"event_menu_color"+ev_me_cl+"_grn mRight2"})).append($("<span/>",{text:ev_me_tit}))))):""!=data&&ulel.append($("<li/>",{ca:"",te:data}).append($("<a/>",{href:"javascript:void(0)"}).append($("<span/>",{class:"mRight2"})).append($("<span/>",{text:data}))))}var separate_text=$(optionRows[ind]).text();ulel.append($("<li/>",{ca:"",te:separate_text}).append($("<a/>",{href:"javascript:void(0)"}).append($("<span/>",{class:"mRight2"})).append($("<span/>",{text:separate_text})))),$.each(user_entry,function(index,obj){var ev_me_tit=obj[0];""!=ev_me_tit&&ulel.append($("<li/>",{ca:"",te:ev_me_tit}).append($("<a/>",{href:"javascript:void(0)"}).append($("<span/>",{class:"mRight2"})).append($("<span/>",{text:ev_me_tit}))))}),$.each(ad_entry,function(index,obj){""!=obj[0]&&(ev_me_cl=0!=obj[1]?obj[1]:"_none",ulel.append($("<li/>",{ca:obj[1],te:obj[0]}).append($("<a/>",{href:"javascript:void(0)"}).append($("<span/>",{class:"event_menu_color"+ev_me_cl+"_grn mRight2"})).append($("<span/>",{text:obj[0]})))))}),ulel.height()>299&&ulel.css({width:ulel.width()+15}),ulel.width()<47&&ulel.css({width:45}),ael.click(function(e){ulel.toggle();var clss=$($(this).children()[2]).attr("class");"undefined"==clss||"pulldownbutton_arrow_up_grn"==clss||""==clss?$(this).children(".pulldownbutton_arrow_up_grn").removeClass("pulldownbutton_arrow_up_grn").addClass("pulldownbutton_arrow_down_grn"):$(this).children(".pulldownbutton_arrow_down_grn").removeClass("pulldownbutton_arrow_down_grn").addClass("pulldownbutton_arrow_up_grn")}),ulel.children("li").click(function(){var sel=$(this).attr("ca"),text=$(this).attr("te"),class_mapping="";""==text&&(text=$(this).children("a").children("span:first").text(),sel="");var changeMenu=function(){if(span_text.text(text),""!=sel&&"0"!=sel)var class_mapping="event_menu_color"+sel+"_grn";else""!=sel&&"0"==sel&&(class_mapping="event_menu_color_none_grn");span_color.attr("class","").addClass(class_mapping+" mRight2"),span_up_down.removeClass("pulldownbutton_arrow_up_grn").addClass("pulldownbutton_arrow_down_grn"),selectionElement.find(":selected").prop("selected",false),optionRows.filter(function(){return text==separate_text&&(text=""),$(this).val()==text+(""!=sel?";#"+sel:"")}).prop("selected",true).trigger("change",[true]),ulel.hide()},needConfirmation=false;$("input[id^=app_item_]").each(function(){if("function"===typeof grn.page.schedule.kintoneRelation.showMenuChangeDialog){var itemId=$(this).attr("id").substr(4);if(grn.page.schedule.kintoneRelation.isAllMenuItem(itemId))return}var val=$(this).val();"undefined"!==typeof val&&""!==val&&(needConfirmation=true)}),needConfirmation&&"function"===typeof grn.page.schedule.kintoneRelation.showMenuChangeDialog?grn.page.schedule.kintoneRelation.showMenuChangeDialog(changeMenu):changeMenu()});var holder=$(document);void 0!=dialogId&&(holder=$("div#"+dialogId)),holder.bind("click",function(e){var clicked=$(e.target);$(clicked.parents()).hasClass("pulldownbutton_standard_grn")||(ulel.hide(),ael.children("span.pulldownbutton_arrow_up_grn").removeClass("pulldownbutton_arrow_up_grn").addClass("pulldownbutton_arrow_down_grn"))});var ite=optionRows.first(),a;if(data=ite.val(),null!=(a=pattern.exec(data))&&a.length>0){var ev_me_tit=a[1],ev_me_cl=0!=a[2]?a[2]:"_none";ite.val(data).text(ev_me_tit),span_text.text(ev_me_tit),span_color.attr("class","").addClass("event_menu_color"+ev_me_cl+"_grn mRight2")}}}(jQuery)}function grn_parseJson(string){try{return JSON.parse(string)}catch(e){return null}}var ua=navigator.userAgent,dp_id,dp_of,tpid=0,tpleft=0,tptop=0,tpval=null;GRN_GroupItem.prototype.getHtml=function(){var html='<a id="grn_group_item_'+this.gid+'"';return this.selected?html+=' class="selected_item dropdown_item"':html+=' class="dropdown_item"',html+=' onClick="'+this.callback+"('"+this.gid+"', '"+escape(this.name)+"', '"+escape(this.extra_param)+"');\"",html+="onMouseOver='javascript:$(this).addClass(\"user_group_hover\");' onMouseOut='javascript:$(this).removeClass(\"user_group_hover\");' ",html+=" ><nobr>"+this.name+"</nobr></a>"},GRN_GroupItem.prototype.isSelected=function(){return this.selected},GRN_GroupItem.prototype.setSelected=function(on_off){this.selected=on_off},GRN_GroupItemManager.prototype.appendItem=function(item){this.items.push(item)},GRN_GroupItemManager.prototype.draw=function(){for(var html="",i=0;i<this.items.length;i++)html+=this.items[i].getHtml();this.getEl().innerHTML=html},GRN_GroupItemManager.prototype.getEl=function(){return this.el_group_item},GRN_GroupItemManager.prototype.getSelectedItem=function(){for(var i=0;i<this.items.length;i++)if(this.items[i].isSelected())return this.items[i]},GRN_GroupItemManager.prototype.selectItem=function(gid){for(var i=0;i<this.items.length;i++)this.items[i].setSelected(this.items[i].gid==gid)},GRN_GroupItemManager.prototype.getItem=function(gid){for(var i=0;i<this.items.length;i++)if(this.items[i].gid==gid)return this.items[i];return false};var Cb_i18n={cb_msg:function(text,keys,replaces){for(var ret=text,i=0;i<keys.length;i++)ret=ret.replace("&&"+keys[i]+"&&",replaces[i],"g");return ret}},GRN_Window={getWidth:function(){return window.innerWidth?window.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body&&document.body.clientWidth?document.body.clientWidth:0},getHeight:function(){return window.innerHeight?window.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body&&document.body.clientHeight?document.body.clientHeight:0}},GRN_Event={fireEvent:function(element,event){var eventObject;return"undefined"!==typeof document.createEvent?((eventObject=document.createEvent("HTMLEvents")).initEvent(event,true,true),!element.dispatchEvent(eventObject)):"undefined"!==typeof document.createEventObject&&(eventObject=document.createEventObject(),element.fireEvent("on"+event,eventObject))},keyCode:function(event){return document.all?event.keyCode:document.getElementById?event.keyCode?event.keyCode:event.charCode:!!document.layers&&event.which}};